<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clash Royale Singleplayer - PC Modu</title>
<style>
/* T√ºm CSS stilleri burada */
body {
    margin:0; padding:0; font-family: Arial; 
    background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.contentstack.io/v3/assets/blt370612131b6e0756/blt7ba8f6f7099e0bd4/5f7f0b8f9f7e730f80b8c8e6/CR_website_hero.jpg') no-repeat center center fixed;
    background-size: cover;
    color:white;
    overflow-x:hidden;
    min-height: 100vh;
}
header {
    background: rgba(0,0,0,0.3); padding:15px; display:flex; justify-content:space-between; align-items:center;
    box-shadow: 0 5px 10px rgba(0,0,0,0.5);
}
#resources { display:flex; gap:15px; font-size:1em; }
nav { display:flex; justify-content:center; gap:15px; padding:10px; }
nav button { padding:8px 15px; background: rgba(0,0,0,0.3); border:none; border-radius:10px; color:white; cursor:pointer; transition:0.3s; }
nav button:hover { background: rgba(255,255,255,0.2); transform: scale(1.05); }

main { 
    display:grid; 
    grid-template-columns: repeat(4, 1fr); 
    gap:20px; 
    padding:20px; 
    max-width: 1200px;
    margin: 0 auto;
}

.menu-card {
    background: rgba(0,0,0,0.4); border:2px solid gold; border-radius:20px; display:flex; flex-direction:column;
    align-items:center; justify-content:center; padding:15px; cursor:pointer; transition:0.3s; text-align:center;
    min-height: 150px;
}
.menu-card:hover { transform: scale(1.05); background: rgba(0,0,0,0.6); }

#shop-screen, #profile-screen, #deck-screen, #battle-screen, #badge-screen, #stats-screen, #leaderboard-screen, #season-screen, #admin-screen, #emoji-selector-screen {
    display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95);
    color:white; flex-direction:column; align-items:center; justify-content:flex-start; padding:20px; overflow:auto;
    z-index: 1000;
}
#shop-screen h2, #profile-screen h2, #deck-screen h2, #battle-screen h2, #badge-screen h2, #stats-screen h2, #leaderboard-screen h2, #season-screen h2, #admin-screen h2, #emoji-selector-screen h2 { color:#ffcc00; margin-bottom:20px; }
#shop-screen button, #profile-screen button, #deck-screen button, #battle-screen button, #badge-screen button, #stats-screen button, #leaderboard-screen button, #season-screen button, #admin-screen button, #emoji-selector-screen button {
    margin:10px; padding:10px 20px; border:none; border-radius:5px; background:#444; color:white; cursor:pointer; transition:0.3s;
}
#shop-screen button:hover, #profile-screen button:hover, #deck-screen button:hover, #battle-screen button:hover, #badge-screen button:hover, #stats-screen button:hover, #leaderboard-screen button:hover, #season-screen button:hover, #admin-screen button:hover, #emoji-selector-screen button:hover {
    background:#666; transform:scale(1.05);
}
#creator-input { margin:10px; padding:5px; border-radius:5px; border:none; width:200px; }
.grid-container { 
    display:grid; 
    grid-template-columns: repeat(6,1fr); 
    gap:10px; 
    max-width: 1000px;
    margin: 0 auto;
}
.grid-card { 
    background: rgba(255,255,255,0.1); 
    padding:10px; 
    border-radius:10px; 
    cursor:pointer; 
    transition:0.2s; 
    text-align:center; 
    min-height: 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.grid-card:hover { transform: scale(1.1); background: rgba(255,255,255,0.2); }
.grid-card.selected { background: rgba(255,215,0,0.3); border: 2px solid gold; }

.badge { font-size:2em; margin-left:5px; }

/* Sava≈ü ekranƒ± stilleri */
.battle-container { 
    display: flex; 
    justify-content: space-between; 
    width: 100%; 
    max-width: 1000px; 
    margin-top: 20px; 
}
.player-area, .opponent-area { 
    width: 45%; 
    text-align: center; 
    padding: 15px; 
    background: rgba(255,255,255,0.1); 
    border-radius: 10px; 
}
.arena { 
    width: 100%; 
    height: 400px; 
    background: linear-gradient(to bottom, #2a8c2a, #1e5a1e); 
    margin: 20px 0; 
    border-radius: 10px; 
    position: relative; 
    overflow: hidden; 
    max-width: 1000px;
}
.emoji-bar { display: flex; justify-content: center; gap: 10px; margin-top: 10px; }
.emoji-btn { font-size: 1.5em; background: none; border: none; cursor: pointer; padding: 5px; }
.emoji-btn:hover { transform: scale(1.2); }
.badge-container { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0; }
.badge-item { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px; text-align: center; width: 120px; }
.badge-item.locked { opacity: 0.5; }
.battle-timer { font-size: 2em; color: #ffcc00; margin: 10px 0; }
.trophy { color: gold; font-weight: bold; }

/* PC i√ßin ek √∂zellikler */
.pc-features {
    display: flex;
    justify-content: space-between;
    margin: 20px auto;
    max-width: 1200px;
    gap: 20px;
}

.pc-feature-card {
    background: rgba(0,0,0,0.4);
    border-radius: 15px;
    padding: 15px;
    flex: 1;
    text-align: center;
}

.deck-preview {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
}

.deck-preview-card {
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 10px;
    width: 60px;
    height: 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.stats-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    max-width: 600px;
    margin: 20px auto;
}

.stat-card {
    background: rgba(255,255,255,0.1);
    padding: 15px;
    border-radius: 10px;
    text-align: center;
}

.close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255,0,0,0.7);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 1.2em;
    cursor: pointer;
    z-index: 1001;
}

.close-btn:hover {
    background: rgba(255,0,0,0.9);
    transform: scale(1.1);
}

/* Animasyonlar */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.pulse {
    animation: pulse 2s infinite;
}

/* Deck Builder i√ßin geli≈ümi≈ü stiller */
.deck-builder-container {
    display: flex;
    width: 100%;
    max-width: 1200px;
    gap: 20px;
}

.deck-builder-cards {
    flex: 3;
}

.deck-builder-preview {
    flex: 1;
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 15px;
}

/* Shop i√ßin geli≈ümi≈ü stiller */
.shop-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    max-width: 1000px;
    margin: 0 auto;
}

.shop-category {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 15px;
}

/* Ma√ß sonu√ß ekranƒ± */
.battle-result {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.9);
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    z-index: 1002;
    border: 3px solid gold;
    min-width: 300px;
}

.battle-result h2 {
    color: gold;
    margin-bottom: 20px;
}

.battle-result button {
    margin-top: 15px;
    padding: 10px 20px;
    background: #444;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: 0.3s;
}

.battle-result button:hover {
    background: #666;
    transform: scale(1.05);
}

/* ESC tu≈üu bilgilendirmesi */
.esc-info {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: rgba(0,0,0,0.7);
    padding: 10px 15px;
    border-radius: 10px;
    font-size: 0.9em;
    z-index: 999;
}

/* Lider tablosu stilleri */
.leaderboard-container {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
}

.leaderboard-header {
    display: flex;
    justify-content: space-between;
    background: rgba(255,215,0,0.2);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 10px;
    font-weight: bold;
}

.leaderboard-item {
    display: flex;
    justify-content: space-between;
    background: rgba(255,255,255,0.1);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 10px;
    transition: 0.3s;
}

.leaderboard-item:hover {
    background: rgba(255,255,255,0.2);
    transform: scale(1.01);
}

.leaderboard-item.current-user {
    background: rgba(0,100,255,0.3);
    border: 2px solid #4d94ff;
}

.rank {
    width: 50px;
    text-align: center;
    font-weight: bold;
}

.player-name {
    flex: 2;
    text-align: left;
}

.player-trophies {
    width: 100px;
    text-align: center;
    font-weight: bold;
}

.player-level {
    width: 80px;
    text-align: center;
}

.medal {
    font-size: 1.5em;
    margin-right: 10px;
}

.rank-1 .medal { color: gold; }
.rank-2 .medal { color: silver; }
.rank-3 .medal { color: #cd7f32; }

.leaderboard-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.leaderboard-tabs button {
    padding: 10px 20px;
    background: rgba(255,255,255,0.1);
    border: none;
    border-radius: 5px;
    color: white;
    cursor: pointer;
    transition: 0.3s;
}

.leaderboard-tabs button.active {
    background: rgba(255,215,0,0.3);
    border: 1px solid gold;
}

.leaderboard-tabs button:hover {
    background: rgba(255,255,255,0.2);
}

/* Sezon ekranƒ± stilleri */
.season-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    max-width: 900px;
    margin: 0 auto;
}

.season-info-card {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 20px;
    text-align: center;
}

.season-timer {
    font-size: 1.5em;
    color: #ffcc00;
    margin: 10px 0;
    font-weight: bold;
}

.season-rewards {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
    margin-top: 20px;
}

.season-reward {
    background: rgba(255,215,0,0.2);
    border-radius: 10px;
    padding: 15px;
    text-align: center;
    width: 120px;
}

.season-history {
    max-height: 400px;
    overflow-y: auto;
    margin-top: 20px;
}

.season-history-item {
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 10px;
    margin-bottom: 10px;
}

.progress-bar {
    width: 100%;
    height: 20px;
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
    margin: 10px 0;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #ffcc00, #ff9900);
    border-radius: 10px;
    transition: width 0.5s ease;
}

/* Admin paneli stilleri */
.admin-panel {
    background: rgba(255,0,0,0.2);
    border: 2px solid red;
    border-radius: 15px;
    padding: 20px;
    margin: 10px 0;
}

.admin-section {
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 15px;
    margin: 10px 0;
}

.admin-input {
    margin: 5px;
    padding: 8px;
    border-radius: 5px;
    border: 1px solid #666;
    background: rgba(255,255,255,0.1);
    color: white;
    width: 120px;
}

.admin-btn {
    background: #ff4444 !important;
    margin: 5px !important;
}

.admin-btn:hover {
    background: #ff6666 !important;
}

/* Emoji se√ßim ekranƒ± i√ßin yeni stiller */
#emoji-selector-screen {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.95);
    color: white;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    padding: 20px;
    overflow: auto;
    z-index: 1000;
}

.selected-emojis-preview {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
    width: 80%;
    max-width: 800px;
    text-align: center;
}

.emoji-list {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
    margin: 15px 0;
}

.emoji-item {
    background: rgba(255,255,255,0.1);
    padding: 15px;
    border-radius: 10px;
    font-size: 2em;
    cursor: pointer;
    transition: 0.3s;
    min-width: 60px;
    text-align: center;
}

.emoji-item:hover {
    background: rgba(255,255,255,0.2);
    transform: scale(1.1);
}

.emoji-item.selected {
    background: rgba(255,215,0,0.3);
    border: 2px solid gold;
}

.emoji-collection {
    background: rgba(255,255,255,0.1);
    border-radius: 15px;
    padding: 20px;
    width: 80%;
    max-width: 800px;
    text-align: center;
}

.emoji-grid {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    gap: 10px;
    margin: 15px 0;
}

.emoji-grid-item {
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 10px;
    font-size: 1.5em;
    cursor: pointer;
    transition: 0.3s;
    text-align: center;
}

.emoji-grid-item:hover {
    background: rgba(255,255,255,0.2);
    transform: scale(1.1);
}

.emoji-grid-item.selected {
    background: rgba(255,215,0,0.3);
    border: 2px solid gold;
}

.emoji-info {
    margin-top: 10px;
    font-size: 0.9em;
    color: #ccc;
}
</style>
</head>
<body>

<header>
    <div style="font-size:2em; color:#ffcc00;">Clash Royale Singleplayer</div>
    <div id="resources">
        <div>üíé Elmas: <span id="gem-count">0</span></div>
        <div>ü™ô Altƒ±n: <span id="gold-count">0</span></div>
        <div>‚≠ê XP: <span id="xp-count">0</span></div>
        <div class="trophy">üèÜ Kupalar: <span id="trophy-count">0</span></div>
        <div>üìÖ Sezon: <span id="season-count">1</span></div>
    </div>
</header>

<nav>
    <button onclick="openDeck()">Deste Olu≈üturucu</button>
    <button onclick="startBattle()">Ma√ß Bul</button>
    <button onclick="openProfile()">Profil</button>
    <button onclick="openShop()">Maƒüaza</button>
    <button onclick="openBadgeScreen()">Rozetler</button>
    <button onclick="openLeaderboard()">Lider Tablosu</button>
    <button onclick="openSeasonScreen()">Sezon</button>
    <button onclick="openEmojiSelector()">Emoji Se√ß</button>
    <button id="admin-btn" onclick="openAdminPanel()" style="display:none; background:red;">Admin Paneli</button>
</nav>

<main>
    <div class="menu-card" onclick="openDeck()"><h3>Deste Olu≈üturucu</h3><p>Kartlarƒ±nƒ± y√∂net ve en iyi desteƒüi kur!</p></div>
    <div class="menu-card" onclick="startBattle()"><h3>Ma√ß Bul</h3><p>Rakiple sava≈ümaya hazƒ±r mƒ±sƒ±n?</p></div>
    <div class="menu-card" onclick="openProfile()"><h3>Profil</h3><p>Kendi profilini y√∂net ve rozetlerini g√∂r!</p></div>
    <div class="menu-card" onclick="openShop()"><h3>Maƒüaza</h3><p>Kart paketleri, elmas ve rozetler al!</p></div>
    <div class="menu-card" onclick="openBadgeScreen()"><h3>Rozetler</h3><p>Koleksiyonunu g√∂r ve yeni rozetler kazan!</p></div>
    <div class="menu-card" onclick="showStats()"><h3>ƒ∞statistikler</h3><p>Detaylƒ± istatistiklerini g√∂r!</p></div>
    <div class="menu-card" onclick="openLeaderboard()"><h3>Lider Tablosu</h3><p>En iyi oyuncularƒ± g√∂r!</p></div>
    <div class="menu-card" onclick="openSeasonScreen()"><h3>Sezon</h3><p>Sezon bilgilerini g√∂r!</p></div>
    <div class="menu-card" onclick="openEmojiSelector()"><h3>Emoji Se√ß</h3><p>Ma√ßlarda kullanmak i√ßin 5 emoji se√ß!</p></div>
    <div class="menu-card" id="admin-menu-card" onclick="openAdminPanel()" style="display:none; border-color:red;"><h3>Admin Paneli</h3><p>Y√∂netici ara√ßlarƒ±</p></div>
</main>

<!-- PC √ñzellikleri -->
<div class="pc-features">
    <div class="pc-feature-card">
        <h3>Mevcut Desten</h3>
        <div class="deck-preview" id="current-deck-preview"></div>
    </div>
    <div class="pc-feature-card">
        <h3>Son Ma√ßlar</h3>
        <div id="recent-matches"></div>
    </div>
    <div class="pc-feature-card">
        <h3>Se√ßili Emojiler</h3>
        <div id="selected-emojis-preview" class="emoji-list"></div>
    </div>
</div>

<!-- ESC tu≈üu bilgilendirmesi -->
<div class="esc-info">Managed By cucu</div>

<!-- EMOJƒ∞ SE√áƒ∞M EKRANI -->
<div id="emoji-selector-screen">
    <button class="close-btn" onclick="closeEmojiSelector()">X</button>
    <h2>Emoji Se√ßici</h2>
    <p>Ma√ßlarda kullanmak i√ßin 5 emoji se√ßin:</p>
    
    <div class="selected-emojis-preview">
        <h3>Se√ßili Emojileriniz</h3>
        <div id="selected-emojis-list" class="emoji-list"></div>
        <p class="emoji-info">Se√ßilen: <span id="selected-count">0</span>/5</p>
        <button onclick="clearSelectedEmojis()">Se√ßimleri Temizle</button>
    </div>
    
    <div class="emoji-collection">
        <h3>Kullanƒ±labilir Emojiler</h3>
        <div id="emoji-collection-list" class="emoji-grid"></div>
    </div>
    
    <button onclick="saveSelectedEmojis()" style="margin-top: 20px;">Emojileri Kaydet</button>
</div>

<!-- ADMIN PANELƒ∞ -->
<div id="admin-screen">
    <button class="close-btn" onclick="closeAdminPanel()">X</button>
    <h2>üëë Admin Paneli</h2>
    
    <div class="admin-panel">
        <h3>Kaynak Y√∂netimi</h3>
        <div class="admin-section">
            <input type="number" id="admin-gems" class="admin-input" placeholder="Elmas">
            <button onclick="setGems()" class="admin-btn">Elmas Ayarla</button>
            
            <input type="number" id="admin-gold" class="admin-input" placeholder="Altƒ±n">
            <button onclick="setGold()" class="admin-btn">Altƒ±n Ayarla</button>
            
            <input type="number" id="admin-xp" class="admin-input" placeholder="XP">
            <button onclick="setXP()" class="admin-btn">XP Ayarla</button>
            
            <input type="number" id="admin-trophies" class="admin-input" placeholder="Kupa">
            <button onclick="setTrophies()" class="admin-btn">Kupa Ayarla</button>
        </div>

        <h3>Sezon Y√∂netimi</h3>
        <div class="admin-section">
            <input type="number" id="admin-season" class="admin-input" placeholder="Sezon No">
            <button onclick="setSeason()" class="admin-btn">Sezon Ayarla</button>
            
            <input type="number" id="admin-season-days" class="admin-input" placeholder="G√ºn Sayƒ±sƒ±">
            <button onclick="setSeasonDays()" class="admin-btn">Sezon S√ºresi Ayarla</button>
            
            <button onclick="endSeasonNow()" class="admin-btn">Sezonu Bitir</button>
            <button onclick="resetSeason()" class="admin-btn">Sezonu Sƒ±fƒ±rla</button>
        </div>

        <h3>Hƒ±zlƒ± ƒ∞≈ülemler</h3>
        <div class="admin-section">
            <button onclick="addResources(1000, 5000, 1000, 500)" class="admin-btn">+1000 Kaynak</button>
            <button onclick="addResources(10000, 50000, 10000, 5000)" class="admin-btn">+10000 Kaynak</button>
            <button onclick="resetAll()" class="admin-btn">Her ≈ûeyi Sƒ±fƒ±rla</button>
            <button onclick="unlockAllBadges()" class="admin-btn">T√ºm Rozetleri A√ß</button>
        </div>

        <h3>Oyuncu ƒ∞statistikleri</h3>
        <div class="admin-section">
            <input type="number" id="admin-wins" class="admin-input" placeholder="Galibiyet">
            <button onclick="setWins()" class="admin-btn">Galibiyet Ayarla</button>
            
            <input type="number" id="admin-matches" class="admin-input" placeholder="Toplam Ma√ß">
            <button onclick="setTotalMatches()" class="admin-btn">Ma√ß Sayƒ±sƒ± Ayarla</button>
            
            <input type="number" id="admin-streak" class="admin-input" placeholder="Galibiyet Serisi">
            <button onclick="setWinStreak()" class="admin-btn">Seri Ayarla</button>
        </div>
    </div>
</div>

<!-- MAƒûAZA -->
<div id="shop-screen">
    <button class="close-btn" onclick="closeShop()">X</button>
    <h2>Maƒüaza</h2>
    
    <div class="shop-container">
        <div class="shop-category">
            <h3>Kart Paketleri</h3>
            <button onclick="buyCardPack('gem',100)">üíé 100 Elmas ile Kart Paketi Al</button>
            <button onclick="buyCardPack('gold',500)">ü™ô 500 Altƒ±n ile Kart Paketi Al</button>
            <button onclick="buyCardPack('special',200)">üíé 200 Elmas ile √ñzel Paket Al</button>
        </div>
        
        <div class="shop-category">
            <h3>Para √áevir</h3>
            <button onclick="buyGemsWithGold(100,1)">ü™ô 100 Altƒ±n = üíé 1 Elmas</button>
            <button onclick="buyGemsWithGold(500,5)">ü™ô 500 Altƒ±n = üíé 5 Elmas</button>
            <button onclick="buyGoldWithGems(10,100)">üíé 10 Elmas = ü™ô 100 Altƒ±n</button>
        </div>
        
        <div class="shop-category">
            <h3>Rozet Satƒ±n Al</h3>
            <button onclick="buyBadge('bronze', 50)">ü•â Bronz Rozet - 50 Elmas</button>
            <button onclick="buyBadge('silver', 100)">ü•à G√ºm√º≈ü Rozet - 100 Elmas</button>
            <button onclick="buyBadge('gold', 200)">ü•á Altƒ±n Rozet - 200 Elmas</button>
            <button onclick="buyBadge('platinum', 500)">üíé Platin Rozet - 500 Elmas</button>
        </div>
    </div>
    
    <h3>ƒ∞√ßerik √úreticilerini Destekle</h3>
    <input type="text" id="creator-input" placeholder="ƒ∞sim girin">
    <button onclick="supportCreator()">Destekle</button>
</div>

<!-- PROFƒ∞L -->
<div id="profile-screen">
    <button class="close-btn" onclick="closeProfile()">X</button>
    <h2>Profil</h2>
    
    <div class="pc-features">
        <div class="pc-feature-card">
            <p>ƒ∞sim: <input type="text" id="profile-name" placeholder="ƒ∞sim girin"> <span id="admin-badge"></span></p>
            <p>Profil Foto: <input type="file" id="profile-img-input" accept="image/*"></p>
            <img id="profile-img" src="" alt="" style="width:120px; height:120px; border-radius:50%; object-fit:cover; display:block; margin:10px 0;">
            <button onclick="saveProfile()">Kaydet</button>
        </div>
        
        <div class="pc-feature-card">
            <h3>ƒ∞statistikler</h3>
            <div class="stats-container">
                <div class="stat-card">
                    <p>Toplam Kupa: <span id="profile-trophies" class="trophy">0</span> üèÜ</p>
                </div>
                <div class="stat-card">
                    <p>Toplam Ma√ß: <span id="profile-total-matches">0</span></p>
                </div>
                <div class="stat-card">
                    <p>Galibiyet: <span id="profile-wins">0</span></p>
                </div>
                <div class="stat-card">
                    <p>Galibiyet Oranƒ±: <span id="profile-win-rate">0%</span></p>
                </div>
            </div>
        </div>
    </div>
    
    <h3>Rozetlerin</h3>
    <div id="profile-badges" class="badge-container"></div>
</div>

<!-- DESTE -->
<div id="deck-screen">
    <button class="close-btn" onclick="closeDeck()">X</button>
    <h2>Deste Olu≈üturucu (8 Kart Se√ßilebilir)</h2>
    
    <div class="deck-builder-container">
        <div class="deck-builder-cards">
            <div class="grid-container" id="card-grid"></div>
        </div>
        
        <div class="deck-builder-preview">
            <h3>Mevcut Deste</h3>
            <div id="deck-preview" class="deck-preview"></div>
            <p>Kart Sayƒ±sƒ±: <span id="deck-count">0</span>/8</p>
            <button onclick="saveDeck()">Desteyi Kaydet</button>
            <button onclick="clearDeck()">Desteyi Temizle</button>
            <button onclick="suggestDeck()">Deste √ñner</button>
        </div>
    </div>
</div>

<!-- SAVA≈û -->
<div id="battle-screen">
    <button class="close-btn" onclick="closeBattle()">X</button>
    <h2>Ma√ß Ba≈üladƒ±!</h2>
    <div class="battle-timer" id="battle-timer">5</div>
    
    <div class="battle-container">
        <div class="player-area">
            <h3>Sen</h3>
            <div class="emoji-bar" id="player-emoji-bar">
                <!-- Emojiler buraya dinamik olarak eklenecek -->
            </div>
            <div class="deck-preview" id="battle-deck-preview"></div>
        </div>
        
        <div class="opponent-area">
            <h3>Rakip</h3>
            <div id="opponent-emojis"></div>
            <div class="deck-preview" id="opponent-deck-preview"></div>
        </div>
    </div>
    
    <div class="arena">
        <div id="battle-log" style="position:absolute; bottom:10px; left:10px; color:white; font-size:1.2em;"></div>
    </div>
</div>

<!-- ROZET EKRANI -->
<div id="badge-screen">
    <button class="close-btn" onclick="closeBadgeScreen()">X</button>
    <h2>Rozetler</h2>
    <div class="badge-container" id="badge-collection"></div>
</div>

<!-- ƒ∞STATƒ∞STƒ∞KLER EKRANI -->
<div id="stats-screen">
    <button class="close-btn" onclick="closeStats()">X</button>
    <h2>Detaylƒ± ƒ∞statistikler</h2>
    
    <div class="stats-container" style="grid-template-columns: repeat(3, 1fr); max-width: 900px;">
        <div class="stat-card">
            <h3>Genel ƒ∞statistikler</h3>
            <p>Toplam Oyun S√ºresi: <span id="total-play-time">0 dk</span></p>
            <p>Ortalama Ma√ß S√ºresi: <span id="avg-match-time">0 dk</span></p>
            <p>En Y√ºksek Kupa: <span id="max-trophies">0</span></p>
        </div>
        
        <div class="stat-card">
            <h3>Sava≈ü ƒ∞statistikleri</h3>
            <p>En √áok Kullanƒ±lan Kart: <span id="most-used-card">-</span></p>
            <p>En Uzun Galibiyet Serisi: <span id="longest-win-streak">0</span></p>
            <p>3 Ta√ßlƒ± Galibiyet: <span id="three-crown-wins">0</span></p>
        </div>
        
        <div class="stat-card">
            <h3>Kaynak ƒ∞statistikleri</h3>
            <p>Toplam Kazanƒ±lan Altƒ±n: <span id="total-gold-earned">0</span></p>
            <p>Toplam Kazanƒ±lan Elmas: <span id="total-gems-earned">0</span></p>
            <p>Toplam Harcanan Altƒ±n: <span id="total-gold-spent">0</span></p>
        </div>
    </div>
    
    <h3>Ma√ß Ge√ßmi≈üi</h3>
    <div id="match-history" style="max-width: 800px; width: 100%;"></div>
</div>

<!-- Lƒ∞DER TABLOSU EKRANI -->
<div id="leaderboard-screen">
    <button class="close-btn" onclick="closeLeaderboard()">X</button>
    <h2>Lider Tablosu</h2>
    
    <div class="leaderboard-tabs">
        <button class="active" onclick="changeLeaderboardTab('global')">K√ºresel</button>
        <button onclick="changeLeaderboardTab('local')">Yerel</button>
        <button onclick="changeLeaderboardTab('clan')">Klan</button>
    </div>
    
    <div class="leaderboard-container" id="leaderboard-content"></div>
</div>

<!-- SEZON EKRANI -->
<div id="season-screen">
    <button class="close-btn" onclick="closeSeasonScreen()">X</button>
    <h2>Sezon Bilgileri</h2>
    
    <div class="season-container">
        <div class="season-info-card">
            <h3>Mevcut Sezon</h3>
            <p>Sezon: <span id="current-season">1</span></p>
            <p>Ba≈ülangƒ±√ß: <span id="season-start-date">-</span></p>
            <p>Biti≈ü: <span id="season-end-date">-</span></p>
            <div class="season-timer" id="season-timer">30 g√ºn</div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="season-progress" style="width: 50%;"></div>
            </div>
            
            <h4>Sezon √ñd√ºlleri</h4>
            <div class="season-rewards">
                <div class="season-reward">
                    <div>ü•á 1.</div>
                    <div>5000 Altƒ±n</div>
                    <div>500 Elmas</div>
                </div>
                <div class="season-reward">
                    <div>ü•à 2.</div>
                    <div>3000 Altƒ±n</div>
                    <div>300 Elmas</div>
                </div>
                <div class="season-reward">
                    <div>ü•â 3.</div>
                    <div>2000 Altƒ±n</div>
                    <div>200 Elmas</div>
                </div>
            </div>
            
            <button onclick="simulateSeasonEnd()" style="margin-top: 20px; background: #ff9900;">Sezon Sonunu Sim√ºle Et</button>
        </div>
        
        <div class="season-info-card">
            <h3>Sezon Ge√ßmi≈üi</h3>
            <div class="season-history" id="season-history"></div>
            
            <h4>Sezon Kurallarƒ±</h4>
            <ul style="text-align: left; padding-left: 20px;">
                <li>Her sezon 30 g√ºn s√ºrer</li>
                <li>Sezon sonunda t√ºm oyuncularƒ±n kupalarƒ± yarƒ±ya iner</li>
                <li>ƒ∞lk 3 sƒ±radaki oyuncular √∂d√ºl kazanƒ±r</li>
                <li>Sezon ba≈üƒ±nda yeni rozetler eklenir</li>
            </ul>
        </div>
    </div>
</div>

<script>
// T√úM DEƒûƒ∞≈ûKENLER
let gems = parseInt(localStorage.getItem('gems')) || 0;
let gold = parseInt(localStorage.getItem('gold')) || 0;
let xp = parseInt(localStorage.getItem('xp')) || 0;
let trophies = parseInt(localStorage.getItem('trophies')) || 0;
let totalMatches = parseInt(localStorage.getItem('totalMatches')) || 0;
let wins = parseInt(localStorage.getItem('wins')) || 0;
let deck = JSON.parse(localStorage.getItem('deck')) || [];
let profileName = localStorage.getItem('profileName') || 'Oyuncu';
let profileImg = localStorage.getItem('profileImg') || '';
let badges = JSON.parse(localStorage.getItem('badges')) || [];
let battleActive = false;
let battleTimer = 5;
let timerInterval = null;
let winStreak = parseInt(localStorage.getItem('winStreak')) || 0;
let maxWinStreak = parseInt(localStorage.getItem('maxWinStreak')) || 0;
let threeCrownWins = parseInt(localStorage.getItem('threeCrownWins')) || 0;
let totalPlayTime = parseInt(localStorage.getItem('totalPlayTime')) || 0;
let totalGoldEarned = parseInt(localStorage.getItem('totalGoldEarned')) || 0;
let totalGemsEarned = parseInt(localStorage.getItem('totalGemsEarned')) || 0;
let totalGoldSpent = parseInt(localStorage.getItem('totalGoldSpent')) || 0;
let matchHistory = JSON.parse(localStorage.getItem('matchHistory')) || [];
let currentLeaderboardTab = 'global';

// Sezon deƒüi≈ükenleri
let currentSeason = parseInt(localStorage.getItem('currentSeason')) || 1;
let seasonStartDate = localStorage.getItem('seasonStartDate') || new Date().toISOString();
let seasonEndDate = localStorage.getItem('seasonEndDate') || calculateSeasonEndDate();
let seasonHistory = JSON.parse(localStorage.getItem('seasonHistory')) || [];
let leaderboardData = JSON.parse(localStorage.getItem('leaderboardData')) || null;

// Emoji deƒüi≈ükenleri
let selectedEmojis = JSON.parse(localStorage.getItem('selectedEmojis')) || ['üòÑ', 'üëë', 'üíÄ', 'üëç', 'üëé'];
let allAvailableEmojis = [
    'üòÑ', 'üòä', 'üòé', 'üòç', 'ü•≥', 'üò¢', 'üò°', 'üò±', 'üò¥', 'ü§î',
    'üëë', 'üíÄ', 'üëª', 'üí©', 'ü§ñ', 'üëæ', 'üêâ', 'ü¶Å', 'üê∏', 'ü¶Ñ',
    'üëç', 'üëé', 'üëä', '‚úåÔ∏è', 'ü§ò', 'üëå', 'ü§ô', 'üôè', 'üí™', 'ü¶µ',
    'üî•', 'üíß', '‚ö°', '‚ùÑÔ∏è', 'üå™Ô∏è', 'üåà', '‚≠ê', 'üåü', 'üí´', '‚ú®',
    '‚öΩ', 'üèÄ', 'üéØ', 'üéÆ', 'üé≤', 'üé®', 'üéµ', 'üé∏', 'üé∫', 'ü•Å',
    'üöÄ', 'üèÜ', 'üé™', 'üé≠', 'üíØ', '‚úÖ', '‚ùå', '‚û°Ô∏è', '‚¨ÖÔ∏è', 'üîÑ'
];

// KARTLAR
const allCards = [
    {emoji:'‚öîÔ∏è', name:'Sava≈ü√ßƒ±', cost: 3, rarity: 'common'}, 
    {emoji:'üèπ', name:'Ok√ßu', cost: 3, rarity: 'common'}, 
    {emoji:'üõ°Ô∏è', name:'Tank', cost: 5, rarity: 'rare'},
    {emoji:'üî•', name:'B√ºy√ºc√º', cost: 4, rarity: 'rare'}, 
    {emoji:'üí£', name:'Bomber', cost: 2, rarity: 'common'}, 
    {emoji:'üêâ', name:'Ejderha', cost: 6, rarity: 'epic'},
    {emoji:'üó°Ô∏è', name:'Suikast√ßƒ±', cost: 4, rarity: 'rare'}, 
    {emoji:'ü¶Ö', name:'Hawkeye', cost: 3, rarity: 'common'},
    {emoji:'‚ö°', name:'Yƒ±ldƒ±rƒ±m', cost: 2, rarity: 'common'},
    {emoji:'‚ùÑÔ∏è', name:'Buz B√ºy√ºs√º', cost: 3, rarity: 'rare'},
    {emoji:'üí•', name:'Ate≈ü Topu', cost: 4, rarity: 'epic'},
    {emoji:'üå™Ô∏è', name:'Kasƒ±rga', cost: 5, rarity: 'epic'},
    {emoji:'üï∑Ô∏è', name:'√ñr√ºmcek', cost: 2, rarity: 'common'},
    {emoji:'ü¶á', name:'Yarasa', cost: 2, rarity: 'common'},
    {emoji:'üëª', name:'Hayalet', cost: 3, rarity: 'rare'},
    {emoji:'üßô', name:'Sihirbaz', cost: 5, rarity: 'epic'}
];

// ROZETLER
const allBadges = [
    {id: 'starter', name: 'Ba≈ülangƒ±√ß Rozeti', emoji: 'üî∞', cost: 0, description: 'Oyunu ba≈ülattƒ±n'},
    {id: 'bronze', name: 'Bronz Rozet', emoji: 'ü•â', cost: 50, description: '50 Elmas kar≈üƒ±lƒ±ƒüƒ±nda satƒ±n alƒ±ndƒ±'},
    {id: 'silver', name: 'G√ºm√º≈ü Rozet', emoji: 'ü•à', cost: 100, description: '100 Elmas kar≈üƒ±lƒ±ƒüƒ±nda satƒ±n alƒ±ndƒ±'},
    {id: 'gold', name: 'Altƒ±n Rozet', emoji: 'ü•á', cost: 200, description: '200 Elmas kar≈üƒ±lƒ±ƒüƒ±nda satƒ±n alƒ±ndƒ±'},
    {id: 'platinum', name: 'Platin Rozet', emoji: 'üíé', cost: 500, description: '500 Elmas kar≈üƒ±lƒ±ƒüƒ±nda satƒ±n alƒ±ndƒ±'},
    {id: 'warrior', name: 'Sava≈ü√ßƒ± Rozeti', emoji: '‚öîÔ∏è', cost: 0, description: '10 ma√ß kazandƒ±n'},
    {id: 'champion', name: '≈ûampiyon Rozeti', emoji: 'üèÜ', cost: 0, description: '100 kupa kazandƒ±n'},
    {id: 'rich', name: 'Zengin Rozeti', emoji: 'üí∞', cost: 0, description: '1000 Altƒ±n biriktirdin'},
    {id: 'collector', name: 'Koleksiyoncu Rozeti', emoji: 'üìö', cost: 0, description: 'T√ºm kartlarƒ± topladƒ±n'},
    {id: 'veteran', name: 'Veteran Rozeti', emoji: 'üéñÔ∏è', cost: 0, description: '100 ma√ß oynadƒ±n'},
    {id: 'streak', name: 'Seri Rozeti', emoji: 'üî•', cost: 0, description: '10 ma√ßlƒ±k galibiyet serisi yaptƒ±n'},
    {id: 'season1', name: 'Sezon 1 Rozeti', emoji: '1Ô∏è‚É£', cost: 0, description: '1. sezonu tamamladƒ±n'},
    {id: 'season2', name: 'Sezon 2 Rozeti', emoji: '2Ô∏è‚É£', cost: 0, description: '2. sezonu tamamladƒ±n'},
    {id: 'season3', name: 'Sezon 3 Rozeti', emoji: '3Ô∏è‚É£', cost: 0, description: '3. sezonu tamamladƒ±n'}
];

// Sahte oyuncu isimleri
const fakePlayerNames = [
    "Sava≈ü√ßƒ±Kral", "EjderhaAvcƒ±sƒ±", "KartUstasƒ±", "KaleYƒ±kƒ±cƒ±", "Ok√ßuKrali√ße", 
    "B√ºy√ºc√ºLord", "TankCanavarƒ±", "ZaferYolcusu", "KupaAvcƒ±sƒ±", "Altƒ±n≈û√∂valye",
    "GizliAvcƒ±", "MaviEjderha", "Kƒ±rmƒ±zƒ±Ok√ßu", "Ye≈üilB√ºy√ºc√º", "MorTank",
    "Ate≈üTopuUstasƒ±", "BuzSihirbazƒ±", "Yƒ±ldƒ±rƒ±mTanrƒ±sƒ±", "Kasƒ±rgaYaratƒ±cƒ±", "HayaletSava≈ü√ßƒ±"
];

// Ba≈ülangƒ±√ß rozetini ekle
if(!badges.includes('starter')) {
    badges.push('starter');
    localStorage.setItem('badges', JSON.stringify(badges));
}

// EMOJƒ∞ FONKSƒ∞YONLARI
function openEmojiSelector() {
    document.getElementById('emoji-selector-screen').style.display = 'flex';
    displaySelectedEmojis();
    displayEmojiCollection();
}

function closeEmojiSelector() {
    document.getElementById('emoji-selector-screen').style.display = 'none';
}

function displaySelectedEmojis() {
    const container = document.getElementById('selected-emojis-list');
    const countElement = document.getElementById('selected-count');
    
    container.innerHTML = '';
    countElement.textContent = selectedEmojis.length;
    
    selectedEmojis.forEach((emoji, index) => {
        const emojiElement = document.createElement('div');
        emojiElement.className = 'emoji-item selected';
        emojiElement.innerHTML = emoji;
        emojiElement.onclick = () => removeEmoji(index);
        container.appendChild(emojiElement);
    });
    
    // Ana sayfadaki √∂nizlemeyi g√ºncelle
    updateEmojiPreview();
}

function displayEmojiCollection() {
    const container = document.getElementById('emoji-collection-list');
    container.innerHTML = '';
    
    allAvailableEmojis.forEach(emoji => {
        const isSelected = selectedEmojis.includes(emoji);
        const emojiElement = document.createElement('div');
        emojiElement.className = `emoji-grid-item ${isSelected ? 'selected' : ''}`;
        emojiElement.innerHTML = emoji;
        
        if (!isSelected) {
            emojiElement.onclick = () => addEmoji(emoji);
        }
        
        container.appendChild(emojiElement);
    });
}

function addEmoji(emoji) {
    if (selectedEmojis.length >= 5) {
        alert('Maksimum 5 emoji se√ßebilirsiniz!');
        return;
    }
    
    selectedEmojis.push(emoji);
    displaySelectedEmojis();
    displayEmojiCollection();
}

function removeEmoji(index) {
    selectedEmojis.splice(index, 1);
    displaySelectedEmojis();
    displayEmojiCollection();
}

function clearSelectedEmojis() {
    if (confirm('T√ºm se√ßili emojileri temizlemek istediƒüinizden emin misiniz?')) {
        selectedEmojis = [];
        displaySelectedEmojis();
        displayEmojiCollection();
    }
}

function saveSelectedEmojis() {
    if (selectedEmojis.length === 0) {
        alert('En az 1 emoji se√ßmelisiniz!');
        return;
    }
    
    localStorage.setItem('selectedEmojis', JSON.stringify(selectedEmojis));
    alert('Emojileriniz kaydedildi!');
    closeEmojiSelector();
}

function updateEmojiPreview() {
    const container = document.getElementById('selected-emojis-preview');
    container.innerHTML = '';
    
    selectedEmojis.forEach(emoji => {
        const emojiElement = document.createElement('div');
        emojiElement.className = 'emoji-item';
        emojiElement.innerHTML = emoji;
        container.appendChild(emojiElement);
    });
    
    // Sava≈ü ekranƒ±ndaki emoji √ßubuƒüunu g√ºncelle
    updateBattleEmojiBar();
}

function updateBattleEmojiBar() {
    const container = document.getElementById('player-emoji-bar');
    if (!container) return;
    
    container.innerHTML = '';
    
    selectedEmojis.forEach(emoji => {
        const emojiButton = document.createElement('button');
        emojiButton.className = 'emoji-btn';
        emojiButton.innerHTML = emoji;
        emojiButton.onclick = () => sendEmoji(emoji);
        container.appendChild(emojiButton);
    });
}

// ADMIN KONTROL√ú
function checkAdmin() {
    if (profileName === 'cucu') {
        document.getElementById('admin-btn').style.display = 'block';
        document.getElementById('admin-menu-card').style.display = 'flex';
    } else {
        document.getElementById('admin-btn').style.display = 'none';
        document.getElementById('admin-menu-card').style.display = 'none';
    }
}

// ADMIN FONKSƒ∞YONLARI
function openAdminPanel() {
    if (profileName !== 'cucu') {
        alert('Admin panele eri≈üim izniniz yok!');
        return;
    }
    document.getElementById('admin-screen').style.display = 'flex';
    // Mevcut deƒüerleri inputlara y√ºkle
    document.getElementById('admin-gems').value = gems;
    document.getElementById('admin-gold').value = gold;
    document.getElementById('admin-xp').value = xp;
    document.getElementById('admin-trophies').value = trophies;
    document.getElementById('admin-season').value = currentSeason;
    document.getElementById('admin-wins').value = wins;
    document.getElementById('admin-matches').value = totalMatches;
    document.getElementById('admin-streak').value = winStreak;
}

function closeAdminPanel() {
    document.getElementById('admin-screen').style.display = 'none';
}

function setGems() {
    const value = parseInt(document.getElementById('admin-gems').value);
    if (!isNaN(value)) {
        gems = value;
        localStorage.setItem('gems', gems);
        updateResources();
        alert('Elmas ayarlandƒ±: ' + value);
    }
}

function setGold() {
    const value = parseInt(document.getElementById('admin-gold').value);
    if (!isNaN(value)) {
        gold = value;
        localStorage.setItem('gold', gold);
        updateResources();
        alert('Altƒ±n ayarlandƒ±: ' + value);
    }
}

function setXP() {
    const value = parseInt(document.getElementById('admin-xp').value);
    if (!isNaN(value)) {
        xp = value;
        localStorage.setItem('xp', xp);
        updateResources();
        alert('XP ayarlandƒ±: ' + value);
    }
}

function setTrophies() {
    const value = parseInt(document.getElementById('admin-trophies').value);
    if (!isNaN(value)) {
        trophies = value;
        localStorage.setItem('trophies', trophies);
        updateResources();
        alert('Kupa ayarlandƒ±: ' + value);
    }
}

function setSeason() {
    const value = parseInt(document.getElementById('admin-season').value);
    if (!isNaN(value)) {
        currentSeason = value;
        localStorage.setItem('currentSeason', currentSeason);
        updateResources();
        alert('Sezon ayarlandƒ±: ' + value);
    }
}

function setSeasonDays() {
    const days = parseInt(document.getElementById('admin-season-days').value);
    if (!isNaN(days)) {
        const startDate = new Date(seasonStartDate);
        const endDate = new Date(startDate);
        endDate.setDate(endDate.getDate() + days);
        seasonEndDate = endDate.toISOString();
        localStorage.setItem('seasonEndDate', seasonEndDate);
        updateSeasonInfo();
        alert('Sezon s√ºresi ayarlandƒ±: ' + days + ' g√ºn');
    }
}

function endSeasonNow() {
    if (confirm('Sezonu ≈üimdi bitirmek istediƒüinizden emin misiniz?')) {
        endSeason();
    }
}

function resetSeason() {
    if (confirm('Sezonu sƒ±fƒ±rlamak istediƒüinizden emin misiniz?')) {
        currentSeason = 1;
        seasonStartDate = new Date().toISOString();
        seasonEndDate = calculateSeasonEndDate();
        seasonHistory = [];
        leaderboardData = null;
        
        localStorage.setItem('currentSeason', currentSeason);
        localStorage.setItem('seasonStartDate', seasonStartDate);
        localStorage.setItem('seasonEndDate', seasonEndDate);
        localStorage.setItem('seasonHistory', JSON.stringify(seasonHistory));
        localStorage.removeItem('leaderboardData');
        
        updateResources();
        alert('Sezon sƒ±fƒ±rlandƒ±!');
    }
}

function addResources(addGems, addGold, addXP, addTrophies) {
    gems += addGems;
    gold += addGold;
    xp += addXP;
    trophies += addTrophies;
    
    localStorage.setItem('gems', gems);
    localStorage.setItem('gold', gold);
    localStorage.setItem('xp', xp);
    localStorage.setItem('trophies', trophies);
    
    updateResources();
    alert(`Kaynaklar eklendi!\nElmas: +${addGems}\nAltƒ±n: +${addGold}\nXP: +${addXP}\nKupa: +${addTrophies}`);
}

function resetAll() {
    if (confirm('T√úM verileri sƒ±fƒ±rlamak istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz!')) {
        localStorage.clear();
        location.reload();
    }
}

function unlockAllBadges() {
    badges = ['starter', 'bronze', 'silver', 'gold', 'platinum', 'warrior', 'champion', 'rich', 'collector', 'veteran', 'streak', 'season1', 'season2', 'season3'];
    localStorage.setItem('badges', JSON.stringify(badges));
    alert('T√ºm rozetler a√ßƒ±ldƒ±!');
}

function setWins() {
    const value = parseInt(document.getElementById('admin-wins').value);
    if (!isNaN(value)) {
        wins = value;
        localStorage.setItem('wins', wins);
        updateResources();
        alert('Galibiyet sayƒ±sƒ± ayarlandƒ±: ' + value);
    }
}

function setTotalMatches() {
    const value = parseInt(document.getElementById('admin-matches').value);
    if (!isNaN(value)) {
        totalMatches = value;
        localStorage.setItem('totalMatches', totalMatches);
        updateResources();
        alert('Toplam ma√ß sayƒ±sƒ± ayarlandƒ±: ' + value);
    }
}

function setWinStreak() {
    const value = parseInt(document.getElementById('admin-streak').value);
    if (!isNaN(value)) {
        winStreak = value;
        localStorage.setItem('winStreak', winStreak);
        if (value > maxWinStreak) {
            maxWinStreak = value;
            localStorage.setItem('maxWinStreak', maxWinStreak);
        }
        updateResources();
        alert('Galibiyet serisi ayarlandƒ±: ' + value);
    }
}

// SEZON FONKSƒ∞YONLARI
function calculateSeasonEndDate() {
    const startDate = new Date(seasonStartDate);
    const endDate = new Date(startDate);
    endDate.setDate(endDate.getDate() + 30);
    return endDate.toISOString();
}

function checkSeasonEnd() {
    const now = new Date();
    const endDate = new Date(seasonEndDate);
    
    if (now >= endDate) {
        endSeason();
    }
}

function endSeason() {
    const oldTrophies = trophies;
    trophies = Math.floor(trophies / 2);
    
    const seasonBadgeId = 'season' + currentSeason;
    if (!badges.includes(seasonBadgeId)) {
        badges.push(seasonBadgeId);
    }
    
    seasonHistory.unshift({
        season: currentSeason,
        endDate: new Date().toLocaleDateString('tr-TR'),
        trophies: oldTrophies,
        finalTrophies: trophies,
        rank: calculateSeasonRank(oldTrophies)
    });
    
    leaderboardData = null;
    localStorage.removeItem('leaderboardData');
    
    currentSeason++;
    seasonStartDate = new Date().toISOString();
    seasonEndDate = calculateSeasonEndDate();
    
    localStorage.setItem('currentSeason', currentSeason);
    localStorage.setItem('seasonStartDate', seasonStartDate);
    localStorage.setItem('seasonEndDate', seasonEndDate);
    localStorage.setItem('seasonHistory', JSON.stringify(seasonHistory));
    localStorage.setItem('badges', JSON.stringify(badges));
    
    alert(`üéâ Sezon ${currentSeason-1} sona erdi!\n\nEski kupa: ${oldTrophies}\nYeni kupa: ${trophies}\n\nTebrikler! Sezon ${currentSeason-1} rozetini kazandƒ±nƒ±z!\nLider tablosu sƒ±fƒ±rlandƒ±!`);
    
    updateResources();
}

function calculateSeasonRank(trophyCount) {
    if (trophyCount >= 4000) return "Efsane";
    if (trophyCount >= 3000) return "≈ûampiyon";
    if (trophyCount >= 2000) return "Usta";
    if (trophyCount >= 1000) return "Altƒ±n";
    if (trophyCount >= 500) return "G√ºm√º≈ü";
    return "Bronz";
}

function updateSeasonInfo() {
    document.getElementById('season-count').textContent = currentSeason;
    
    const seasonPreview = document.getElementById('season-preview');
    if (seasonPreview) {
        const now = new Date();
        const endDate = new Date(seasonEndDate);
        const daysLeft = Math.ceil((endDate - now) / (1000 * 60 * 60 * 24));
        
        seasonPreview.innerHTML = `
            <p>Sezon ${currentSeason}</p>
            <p>Kalan: ${daysLeft} g√ºn</p>
            <p>Kupa: ${trophies}</p>
        `;
    }
    
    if (document.getElementById('season-screen').style.display === 'flex') {
        updateSeasonScreen();
    }
}

function updateSeasonScreen() {
    const now = new Date();
    const startDate = new Date(seasonStartDate);
    const endDate = new Date(seasonEndDate);
    const daysLeft = Math.ceil((endDate - now) / (1000 * 60 * 60 * 24));
    const totalDays = 30;
    const daysPassed = totalDays - daysLeft;
    const progress = (daysPassed / totalDays) * 100;
    
    document.getElementById('current-season').textContent = currentSeason;
    document.getElementById('season-start-date').textContent = startDate.toLocaleDateString('tr-TR');
    document.getElementById('season-end-date').textContent = endDate.toLocaleDateString('tr-TR');
    document.getElementById('season-timer').textContent = `${daysLeft} g√ºn kaldƒ±`;
    document.getElementById('season-progress').style.width = `${progress}%`;
    
    const seasonHistoryContainer = document.getElementById('season-history');
    seasonHistoryContainer.innerHTML = '';
    
    if (seasonHistory.length === 0) {
        seasonHistoryContainer.innerHTML = '<p>Hen√ºz sezon ge√ßmi≈üi yok.</p>';
    } else {
        seasonHistory.forEach(season => {
            const historyItem = document.createElement('div');
            historyItem.className = 'season-history-item';
            historyItem.innerHTML = `
                <strong>Sezon ${season.season}</strong> - ${season.endDate}<br>
                Sƒ±ralama: ${season.rank} | Kupa: ${season.trophies} ‚Üí ${season.finalTrophies}
            `;
            seasonHistoryContainer.appendChild(historyItem);
        });
    }
}

function simulateSeasonEnd() {
    if (confirm('Sezon sonunu sim√ºle etmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz!')) {
        endSeason();
    }
}

// ESC tu≈üu ile ekran kapatma
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeAllScreens();
    }
});

function closeAllScreens() {
    closeShop();
    closeProfile();
    closeDeck();
    closeBattle();
    closeBadgeScreen();
    closeStats();
    closeLeaderboard();
    closeSeasonScreen();
    closeAdminPanel();
    closeEmojiSelector();
}

function updateResources(){
    document.getElementById('gem-count').textContent = gems;
    document.getElementById('gold-count').textContent = gold;
    document.getElementById('xp-count').textContent = xp;
    document.getElementById('trophy-count').textContent = trophies;
    localStorage.setItem('gems', gems);
    localStorage.setItem('gold', gold);
    localStorage.setItem('xp', xp);
    localStorage.setItem('trophies', trophies);
    localStorage.setItem('totalMatches', totalMatches);
    localStorage.setItem('wins', wins);
    localStorage.setItem('winStreak', winStreak);
    localStorage.setItem('maxWinStreak', maxWinStreak);
    localStorage.setItem('threeCrownWins', threeCrownWins);
    localStorage.setItem('totalPlayTime', totalPlayTime);
    localStorage.setItem('totalGoldEarned', totalGoldEarned);
    localStorage.setItem('totalGemsEarned', totalGemsEarned);
    localStorage.setItem('totalGoldSpent', totalGoldSpent);
    localStorage.setItem('matchHistory', JSON.stringify(matchHistory));
    
    updateDeckPreview();
    updateRecentMatches();
    updateSeasonInfo();
    updateEmojiPreview();
}

// MAƒûAZA FONKSƒ∞YONLARI
function openShop(){ 
    document.getElementById('shop-screen').style.display='flex'; 
}
function closeShop(){ 
    document.getElementById('shop-screen').style.display='none'; 
}

function buyCardPack(type,cost){
    if(type==='gem' && gems>=cost){ 
        gems-=cost; 
        xp+=50; 
        gold+=10;
        totalGoldEarned += 10;
        alert('+50 XP ve +10 Altƒ±n kazandƒ±nƒ±z'); 
    }
    else if(type==='gold' && gold>=cost){ 
        gold-=cost; 
        totalGoldSpent += cost;
        xp+=50; 
        alert('+50 XP kazandƒ±nƒ±z'); 
    }
    else if(type==='special' && gems>=cost){ 
        gems-=cost; 
        xp+=100; 
        gold+=50;
        totalGoldEarned += 50;
        alert('+100 XP ve +50 Altƒ±n kazandƒ±nƒ±z'); 
    }
    else alert('Yeterli kaynak yok!');
    updateResources();
}

function buyGemsWithGold(costGold,gemsAmount){
    if(gold>=costGold){ 
        gold-=costGold; 
        totalGoldSpent += costGold;
        gems+=gemsAmount; 
        totalGemsEarned += gemsAmount;
        updateResources(); 
        alert(`${gemsAmount} Elmas aldƒ±nƒ±z!`);
    }
    else alert('Yeterli Altƒ±n yok!');
}

function buyGoldWithGems(costGems, goldAmount) {
    if(gems>=costGems){ 
        gems-=costGems; 
        gold+=goldAmount; 
        totalGoldEarned += goldAmount;
        updateResources(); 
        alert(`${goldAmount} Altƒ±n aldƒ±nƒ±z!`);
    }
    else alert('Yeterli Elmas yok!');
}

function buyBadge(type, cost) {
    if(gems >= cost) {
        gems -= cost;
        if(!badges.includes(type)) {
            badges.push(type);
            localStorage.setItem('badges', JSON.stringify(badges));
            alert(`${type} rozetini satƒ±n aldƒ±nƒ±z!`);
            
            if(document.getElementById('badge-screen').style.display === 'flex') {
                displayBadgeCollection();
            }
            if(document.getElementById('profile-screen').style.display === 'flex') {
                displayProfileBadges();
            }
        } else {
            alert('Bu rozete zaten sahipsiniz!');
        }
        updateResources();
    } else {
        alert('Yeterli Elmas yok!');
    }
}

function supportCreator(){
    const valid=['Hypnos CR','SeeOk','cucu'];
    const val=document.getElementById('creator-input').value.trim();
    if(valid.includes(val)) {
        alert(`${val} i√ßerik √ºreticisine destek verdiniz!`);
        gold += 5;
        updateResources();
    }
    else alert('Ge√ßersiz isim!');
}

// PROFƒ∞L FONKSƒ∞YONLARI
function openProfile(){
    document.getElementById('profile-screen').style.display='flex';
    document.getElementById('profile-name').value=profileName;
    if(profileImg) document.getElementById('profile-img').src=profileImg;
    updateAdminBadge();
    displayProfileBadges();
    updateProfileStats();
}
function closeProfile(){ document.getElementById('profile-screen').style.display='none'; }

function updateProfileStats() {
    document.getElementById('profile-trophies').textContent = trophies;
    document.getElementById('profile-total-matches').textContent = totalMatches;
    document.getElementById('profile-wins').textContent = wins;
    
    const winRate = totalMatches > 0 ? Math.round((wins / totalMatches) * 100) : 0;
    document.getElementById('profile-win-rate').textContent = winRate + '%';
}

document.getElementById('profile-img-input').addEventListener('change', function(e){
    const file=e.target.files[0];
    if(file){
        const reader=new FileReader();
        reader.onload=function(evt){ document.getElementById('profile-img').src=evt.target.result; }
        reader.readAsDataURL(file);
    }
});

function saveProfile(){
    profileName=document.getElementById('profile-name').value;
    profileImg=document.getElementById('profile-img').src;
    localStorage.setItem('profileName', profileName);
    localStorage.setItem('profileImg', profileImg);
    updateAdminBadge();
    checkAdmin();
    alert('Profil kaydedildi!');
}

function updateAdminBadge(){
    if(profileName==='cucu') document.getElementById('admin-badge').textContent=' üèÖ Admin';
    else document.getElementById('admin-badge').textContent='';
}

function displayProfileBadges() {
    const container = document.getElementById('profile-badges');
    container.innerHTML = '';
    
    badges.forEach(badgeId => {
        const badge = allBadges.find(b => b.id === badgeId);
        if(badge) {
            const badgeElement = document.createElement('div');
            badgeElement.className = 'badge-item';
            badgeElement.innerHTML = `
                <div style="font-size:2em">${badge.emoji}</div>
                <div>${badge.name}</div>
            `;
            container.appendChild(badgeElement);
        }
    });
}

// DESTE FONKSƒ∞YONLARI
function openDeck(){
    document.getElementById('deck-screen').style.display='flex';
    const grid=document.getElementById('card-grid');
    grid.innerHTML='';
    allCards.forEach((c,index)=>{
        const card=document.createElement('div');
        card.className='grid-card';
        card.innerHTML=`${c.emoji} <br>${c.name} <br><small>${c.cost} Elixir</small>`;
        
        const isInDeck = deck.some(d => d.name === c.name);
        if(isInDeck) {
            card.classList.add('selected');
        }
        
        card.onclick=()=>{
            if(deck.some(d => d.name === c.name)){
                deck = deck.filter(d => d.name !== c.name);
                card.classList.remove('selected');
                alert(`${c.name} kaldƒ±rƒ±ldƒ±`);
            } else {
                if(deck.length>=8){ alert('Maksimum 8 kart se√ßebilirsiniz!'); return; }
                deck.push(c);
                card.classList.add('selected');
                alert(`${c.name} se√ßildi`);
            }
            updateDeckPreview();
            localStorage.setItem('deck', JSON.stringify(deck));
        };
        grid.appendChild(card);
    });
    
    updateDeckPreview();
}
function closeDeck(){ document.getElementById('deck-screen').style.display='none'; }

function updateDeckPreview() {
    const deckPreview = document.getElementById('deck-preview');
    const deckCount = document.getElementById('deck-count');
    const currentDeckPreview = document.getElementById('current-deck-preview');
    
    deckPreview.innerHTML = '';
    currentDeckPreview.innerHTML = '';
    deckCount.textContent = deck.length;
    
    deck.forEach(card => {
        const cardElement = document.createElement('div');
        cardElement.className = 'deck-preview-card';
        cardElement.innerHTML = `${card.emoji}<br><small>${card.name}</small>`;
        deckPreview.appendChild(cardElement);
        
        const mainCardElement = document.createElement('div');
        mainCardElement.className = 'deck-preview-card';
        mainCardElement.innerHTML = `${card.emoji}<br><small>${card.name}</small>`;
        currentDeckPreview.appendChild(mainCardElement);
    });
    
    const battleDeckPreview = document.getElementById('battle-deck-preview');
    if(battleDeckPreview) {
        battleDeckPreview.innerHTML = '';
        deck.forEach(card => {
            const cardElement = document.createElement('div');
            cardElement.className = 'deck-preview-card';
            cardElement.innerHTML = `${card.emoji}<br><small>${card.name}</small>`;
            battleDeckPreview.appendChild(cardElement);
        });
    }
}

function saveDeck() {
    if(deck.length === 8) {
        localStorage.setItem('deck', JSON.stringify(deck));
        alert('Deste kaydedildi!');
    } else {
        alert('Deste 8 kart i√ßermelidir!');
    }
}

function clearDeck() {
    if(confirm('Deste temizlenecek, emin misiniz?')) {
        deck = [];
        localStorage.setItem('deck', JSON.stringify(deck));
        openDeck();
        alert('Deste temizlendi!');
    }
}

function suggestDeck() {
    if(deck.length > 0 && deck.length < 8) {
        const suggestedCards = allCards.filter(card => 
            !deck.some(d => d.name === card.name)
        ).sort(() => 0.5 - Math.random()).slice(0, 8 - deck.length);
        
        deck = [...deck, ...suggestedCards];
        localStorage.setItem('deck', JSON.stringify(deck));
        openDeck();
        alert('Deste √∂nerildi ve eklendi!');
    } else if(deck.length === 0) {
        deck = [...allCards].sort(() => 0.5 - Math.random()).slice(0, 8);
        localStorage.setItem('deck', JSON.stringify(deck));
        openDeck();
        alert('Rastgele deste olu≈üturuldu!');
    } else {
        alert('Deste zaten 8 kart i√ßeriyor!');
    }
}

// SAVA≈û FONKSƒ∞YONLARI
function startBattle(){
    if(deck.length < 8){ 
        alert('√ñnce 8 kartlƒ±k deste olu≈ütur!'); 
        openDeck();
        return; 
    }
    
    document.getElementById('battle-screen').style.display='flex';
    battleActive = true;
    battleTimer = 5;
    document.getElementById('battle-timer').textContent = battleTimer;
    document.getElementById('battle-log').textContent = "Ma√ß ba≈üladƒ±! Rakibinize emoji g√∂nderebilirsiniz.";
    
    // Emoji √ßubuƒüunu g√ºncelle
    updateBattleEmojiBar();
    
    const opponentDeck = [...allCards].sort(() => 0.5 - Math.random()).slice(0, 8);
    const opponentDeckPreview = document.getElementById('opponent-deck-preview');
    opponentDeckPreview.innerHTML = '';
    opponentDeck.forEach(card => {
        const cardElement = document.createElement('div');
        cardElement.className = 'deck-preview-card';
        cardElement.innerHTML = `${card.emoji}<br><small>${card.name}</small>`;
        opponentDeckPreview.appendChild(cardElement);
    });
    
    // Timer'ƒ± temizle
    if(timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
    }
    
    // Yeni timer ba≈ülat
    timerInterval = setInterval(() => {
        battleTimer--;
        document.getElementById('battle-timer').textContent = battleTimer;
        
        if(battleTimer <= 0) {
            finishBattle();
        }
    }, 1000);
}

function finishBattle() {
    if(battleActive) {
        // Timer'ƒ± temizle
        if(timerInterval) {
            clearInterval(timerInterval);
            timerInterval = null;
        }
        
        battleActive = false;
        
        // Ma√ß istatistiklerini g√ºncelle
        totalMatches++;
        
        // %80 kazanma ≈üansƒ±
        const isWin = Math.random() < 0.8;
        
        if(isWin) {
            wins++;
            winStreak++;
            if(winStreak > maxWinStreak) {
                maxWinStreak = winStreak;
            }
            
            // KESƒ∞N √ñD√úLLER
            trophies += 30;
            gold += 50;
            xp += 25;
            
            totalGoldEarned += 50;
            
            const isThreeCrown = Math.random() < 0.3;
            if (isThreeCrown) {
                threeCrownWins++;
            }
            
            // Ma√ß ge√ßmi≈üine ekle
            matchHistory.unshift({
                result: 'win',
                trophies: 30,
                gold: 50,
                xp: 25,
                date: new Date().toLocaleDateString('tr-TR'),
                threeCrown: isThreeCrown
            });
            
            // En son 10 ma√ßƒ± sakla
            if(matchHistory.length > 10) {
                matchHistory = matchHistory.slice(0, 10);
            }
            
            // Lider tablosunu g√ºncelle
            updateLeaderboardWithCurrentPlayer();
            
            updateResources();
            
            showBattleResult(true, isThreeCrown, 50, 25);
            
            checkBadges();
            
        } else {
            const trophyLoss = Math.min(15, trophies);
            trophies -= trophyLoss;
            winStreak = 0;
            
            matchHistory.unshift({
                result: 'loss',
                trophies: -trophyLoss,
                gold: 0,
                xp: 0,
                date: new Date().toLocaleDateString('tr-TR'),
                threeCrown: false
            });
            
            if(matchHistory.length > 10) {
                matchHistory = matchHistory.slice(0, 10);
            }
            
            // Lider tablosunu g√ºncelle
            updateLeaderboardWithCurrentPlayer();
            
            updateResources();
            
            showBattleResult(false, false, 0, 0, trophyLoss);
        }
        
        totalPlayTime += 5;
    }
}

function showBattleResult(isWin, isThreeCrown, goldReward, xpReward, trophyLoss = 0) {
    const existingResult = document.querySelector('.battle-result');
    if(existingResult) {
        existingResult.remove();
    }
    
    const resultDiv = document.createElement('div');
    resultDiv.className = 'battle-result';
    
    if(isWin) {
        resultDiv.innerHTML = `
            <h2>üéâ Ma√ßƒ± Kazandƒ±nƒ±z!</h2>
            <p>${isThreeCrown ? '3 Ta√ßlƒ± Galibiyet! üëëüëëüëë' : 'Galibiyet!'}</p>
            <p>+30 Kupa üèÜ</p>
            <p>+${goldReward} Altƒ±n ü™ô</p>
            <p>+${xpReward} XP ‚≠ê</p>
            <p>Galibiyet Serisi: ${winStreak} üî•</p>
            <button onclick="closeBattleResult()">Tamam</button>
        `;
    } else {
        resultDiv.innerHTML = `
            <h2>üíî Ma√ßƒ± Kaybettiniz</h2>
            <p>-${trophyLoss} Kupa üèÜ</p>
            <p>Daha iyi ≈üans next time!</p>
            <button onclick="closeBattleResult()">Tamam</button>
        `;
    }
    
    document.getElementById('battle-screen').appendChild(resultDiv);
}

function closeBattleResult() {
    const resultDiv = document.querySelector('.battle-result');
    if(resultDiv) {
        resultDiv.remove();
    }
    closeBattle();
}

function closeBattle(){ 
    if(timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
    }
    
    document.getElementById('battle-screen').style.display='none'; 
    battleActive = false;
    document.getElementById('opponent-emojis').innerHTML = '';
    document.getElementById('battle-log').textContent = '';
    
    const resultDiv = document.querySelector('.battle-result');
    if(resultDiv) {
        resultDiv.remove();
    }
}

function sendEmoji(emoji) {
    if(!battleActive) return;
    
    document.getElementById('battle-log').textContent = `Sen: ${emoji}`;
    
    setTimeout(() => {
        const opponentEmojis = ['üëã', 'üòÑ', 'üò°', 'üëë', 'üíÄ', 'üëç', 'üëé'];
        const randomEmoji = opponentEmojis[Math.floor(Math.random() * opponentEmojis.length)];
        document.getElementById('opponent-emojis').innerHTML = `Rakip: ${randomEmoji}`;
    }, 1000);
}

// ROZET KONTROL
function checkBadges() {
    if(wins >= 10 && !badges.includes('warrior')) {
        badges.push('warrior');
        localStorage.setItem('badges', JSON.stringify(badges));
        alert('Yeni rozet kazandƒ±nƒ±z: Sava≈ü√ßƒ± Rozeti! ‚öîÔ∏è');
    }
    
    if(trophies >= 100 && !badges.includes('champion')) {
        badges.push('champion');
        localStorage.setItem('badges', JSON.stringify(badges));
        alert('Yeni rozet kazandƒ±nƒ±z: ≈ûampiyon Rozeti! üèÜ');
    }
    
    if(winStreak >= 10 && !badges.includes('streak')) {
        badges.push('streak');
        localStorage.setItem('badges', JSON.stringify(badges));
        alert('Yeni rozet kazandƒ±nƒ±z: Seri Rozeti! üî•');
    }
    
    if(gold >= 1000 && !badges.includes('rich')) {
        badges.push('rich');
        localStorage.setItem('badges', JSON.stringify(badges));
        alert('Yeni rozet kazandƒ±nƒ±z: Zengin Rozeti! üéâ');
    }
    
    if(deck.length === 8 && !badges.includes('collector')) {
        badges.push('collector');
        localStorage.setItem('badges', JSON.stringify(badges));
        alert('Yeni rozet kazandƒ±nƒ±z: Koleksiyoncu Rozeti! üìö');
    }
    
    if(totalMatches >= 100 && !badges.includes('veteran')) {
        badges.push('veteran');
        localStorage.setItem('badges', JSON.stringify(badges));
        alert('Yeni rozet kazandƒ±nƒ±z: Veteran Rozeti! üéñÔ∏è');
    }
}

// ROZET EKRANI
function openBadgeScreen() {
    document.getElementById('badge-screen').style.display = 'flex';
    displayBadgeCollection();
}

function closeBadgeScreen() {
    document.getElementById('badge-screen').style.display = 'none';
}

function displayBadgeCollection() {
    const container = document.getElementById('badge-collection');
    container.innerHTML = '';
    
    allBadges.forEach(badge => {
        const hasBadge = badges.includes(badge.id);
        const badgeElement = document.createElement('div');
        badgeElement.className = `badge-item ${hasBadge ? '' : 'locked'}`;
        badgeElement.innerHTML = `
            <div style="font-size:2em">${badge.emoji}</div>
            <div><strong>${badge.name}</strong></div>
            <div style="font-size:0.8em">${badge.description}</div>
            <div style="font-size:0.8em; margin-top:5px;">${hasBadge ? '‚úÖ Sahip' : (badge.cost > 0 ? `üíé ${badge.cost} Elmas` : 'Kazanƒ±labilir')}</div>
        `;
        
        if(!hasBadge && badge.cost > 0) {
            const buyButton = document.createElement('button');
            buyButton.textContent = 'Satƒ±n Al';
            buyButton.style.marginTop = '5px';
            buyButton.onclick = () => buyBadge(badge.id, badge.cost);
            badgeElement.appendChild(buyButton);
        }
        
        container.appendChild(badgeElement);
    });
}

// ƒ∞STATƒ∞STƒ∞KLER
function showStats() {
    document.getElementById('stats-screen').style.display = 'flex';
    updateStats();
}

function closeStats() {
    document.getElementById('stats-screen').style.display = 'none';
}

function updateStats() {
    document.getElementById('total-play-time').textContent = totalPlayTime;
    document.getElementById('avg-match-time').textContent = totalMatches > 0 ? Math.round(totalPlayTime / totalMatches) : 0;
    document.getElementById('max-trophies').textContent = Math.max(trophies, parseInt(localStorage.getItem('maxTrophies') || 0));
    localStorage.setItem('maxTrophies', Math.max(trophies, parseInt(localStorage.getItem('maxTrophies') || 0)));
    
    const mostUsedCard = getMostUsedCard();
    document.getElementById('most-used-card').textContent = mostUsedCard ? mostUsedCard.name + ' ' + mostUsedCard.emoji : '-';
    document.getElementById('longest-win-streak').textContent = maxWinStreak;
    document.getElementById('three-crown-wins').textContent = threeCrownWins;
    
    document.getElementById('total-gold-earned').textContent = totalGoldEarned;
    document.getElementById('total-gems-earned').textContent = totalGemsEarned;
    document.getElementById('total-gold-spent').textContent = totalGoldSpent;
    
    updateMatchHistory();
}

function getMostUsedCard() {
    if(deck.length > 0) {
        return deck[0];
    }
    return null;
}

function updateMatchHistory() {
    const container = document.getElementById('match-history');
    container.innerHTML = '';
    
    if(matchHistory.length === 0) {
        container.innerHTML = '<p>Hen√ºz ma√ß ge√ßmi≈üi yok.</p>';
        return;
    }
    
    matchHistory.forEach(match => {
        const matchElement = document.createElement('div');
        matchElement.style.background = 'rgba(255,255,255,0.1)';
        matchElement.style.padding = '10px';
        matchElement.style.borderRadius = '5px';
        matchElement.style.marginBottom = '10px';
        matchElement.style.display = 'flex';
        matchElement.style.justifyContent = 'space-between';
        matchElement.style.alignItems = 'center';
        
        const resultIcon = match.result === 'win' ? '‚úÖ' : '‚ùå';
        const trophyChange = match.trophies > 0 ? `+${match.trophies}` : match.trophies;
        const crownIcon = match.threeCrown ? ' üëëüëëüëë' : '';
        
        matchElement.innerHTML = `
            <div>
                <span style="font-size:1.2em">${resultIcon}</span>
                <span>${match.date}</span>
            </div>
            <div>
                <span>${trophyChange} Kupa</span>
                ${match.gold > 0 ? `<span> | +${match.gold} Altƒ±n</span>` : ''}
                ${match.xp > 0 ? `<span> | +${match.xp} XP</span>` : ''}
                ${crownIcon}
            </div>
        `;
        
        container.appendChild(matchElement);
    });
}

// SON MA√áLAR
function updateRecentMatches() {
    const container = document.getElementById('recent-matches');
    container.innerHTML = '';
    
    if(matchHistory.length === 0) {
        container.innerHTML = '<p>Hen√ºz ma√ß yok.</p>';
        return;
    }
    
    const recentMatches = matchHistory.slice(0, 3);
    
    recentMatches.forEach(match => {
        const matchElement = document.createElement('div');
        matchElement.style.marginBottom = '5px';
        matchElement.style.display = 'flex';
        matchElement.style.justifyContent = 'space-between';
        
        const resultIcon = match.result === 'win' ? '‚úÖ' : '‚ùå';
        const trophyChange = match.trophies > 0 ? `+${match.trophies}` : match.trophies;
        
        matchElement.innerHTML = `
            <span>${resultIcon}</span>
            <span>${trophyChange}</span>
        `;
        
        container.appendChild(matchElement);
    });
}

// Lƒ∞DER TABLOSU FONKSƒ∞YONLARI
function generateFixedLeaderboard() {
    // localStorage'dan lider tablosu verilerini al
    const savedLeaderboard = localStorage.getItem('leaderboardData');
    if (savedLeaderboard) {
        leaderboardData = JSON.parse(savedLeaderboard);
        // Eƒüer sezon deƒüi≈ümi≈üse lider tablosunu sƒ±fƒ±rla
        if (leaderboardData.season !== currentSeason) {
            leaderboardData = null;
            localStorage.removeItem('leaderboardData');
        }
    }
    
    if (!leaderboardData) {
        leaderboardData = {
            season: currentSeason,
            players: [],
            lastUpdated: new Date().toISOString()
        };
        
        const playerLevel = Math.floor(xp / 100) + 1;
        
        let fakePlayers = [];
        
        for (let i = 0; i < 19; i++) {
            const fakeTrophies = Math.floor(Math.random() * 3000) + 500;
            const fakeLevel = Math.floor(Math.random() * 10) + 1;
            const fakeName = fakePlayerNames[Math.floor(Math.random() * fakePlayerNames.length)];
            
            fakePlayers.push({
                name: fakeName,
                trophies: fakeTrophies,
                level: fakeLevel,
                isCurrentUser: false
            });
        }
        
        // Mevcut oyuncuyu ekle
        leaderboardData.players = [
            {
                name: profileName,
                trophies: trophies,
                level: playerLevel,
                isCurrentUser: true
            },
            ...fakePlayers
        ];
        
        // Kupalara g√∂re sƒ±rala
        leaderboardData.players.sort((a, b) => b.trophies - a.trophies);
        
        // localStorage'a kaydet
        localStorage.setItem('leaderboardData', JSON.stringify(leaderboardData));
    } else {
        // Mevcut lider tablosunu g√ºncelle
        updateLeaderboardWithCurrentPlayer();
    }
    
    return leaderboardData.players;
}

function updateLeaderboardWithCurrentPlayer() {
    if (!leaderboardData) return;
    
    const playerLevel = Math.floor(xp / 100) + 1;
    
    // Mevcut oyuncuyu bul veya ekle
    let currentPlayerIndex = leaderboardData.players.findIndex(player => player.isCurrentUser);
    
    if (currentPlayerIndex !== -1) {
        // Mevcut oyuncuyu g√ºncelle
        leaderboardData.players[currentPlayerIndex] = {
            name: profileName,
            trophies: trophies,
            level: playerLevel,
            isCurrentUser: true
        };
    } else {
        // Yeni oyuncu ekle
        leaderboardData.players.push({
            name: profileName,
            trophies: trophies,
            level: playerLevel,
            isCurrentUser: true
        });
    }
    
    // Kupalara g√∂re yeniden sƒ±rala
    leaderboardData.players.sort((a, b) => b.trophies - a.trophies);
    
    // G√ºncelleme zamanƒ±nƒ± kaydet
    leaderboardData.lastUpdated = new Date().toISOString();
    
    // localStorage'a kaydet
    localStorage.setItem('leaderboardData', JSON.stringify(leaderboardData));
}

function openLeaderboard() {
    document.getElementById('leaderboard-screen').style.display = 'flex';
    // Lider tablosunu g√ºncelle
    updateLeaderboardWithCurrentPlayer();
    generateLeaderboard();
}

function closeLeaderboard() {
    document.getElementById('leaderboard-screen').style.display = 'none';
}

function changeLeaderboardTab(tab) {
    currentLeaderboardTab = tab;
    
    document.querySelectorAll('.leaderboard-tabs button').forEach(button => {
        button.classList.remove('active');
    });
    event.target.classList.add('active');
    
    generateLeaderboard();
}

function generateLeaderboard() {
    const container = document.getElementById('leaderboard-content');
    container.innerHTML = '';
    
    const header = document.createElement('div');
    header.className = 'leaderboard-header';
    header.innerHTML = `
        <div class="rank">Sƒ±ra</div>
        <div class="player-name">Oyuncu</div>
        <div class="player-trophies">Kupa</div>
        <div class="player-level">Seviye</div>
    `;
    container.appendChild(header);
    
    const allPlayers = generateFixedLeaderboard();
    
    allPlayers.forEach((player, index) => {
        const rank = index + 1;
        const playerElement = document.createElement('div');
        playerElement.className = `leaderboard-item ${player.isCurrentUser ? 'current-user' : ''} rank-${rank}`;
        
        let medal = '';
        if (rank === 1) medal = 'ü•á';
        else if (rank === 2) medal = 'ü•à';
        else if (rank === 3) medal = 'ü•â';
        
        playerElement.innerHTML = `
            <div class="rank">${rank}</div>
            <div class="player-name"><span class="medal">${medal}</span> ${player.name} ${player.isCurrentUser ? '(Siz)' : ''}</div>
            <div class="player-trophies">${player.trophies}</div>
            <div class="player-level">${player.level}</div>
        `;
        
        container.appendChild(playerElement);
    });
    
    // Son g√ºncelleme zamanƒ±nƒ± g√∂ster
    if (leaderboardData && leaderboardData.lastUpdated) {
        const updateInfo = document.createElement('div');
        updateInfo.style.marginTop = '20px';
        updateInfo.style.fontSize = '0.8em';
        updateInfo.style.color = '#ccc';
        updateInfo.innerHTML = `Son g√ºncelleme: ${new Date(leaderboardData.lastUpdated).toLocaleTimeString('tr-TR')}`;
        container.appendChild(updateInfo);
    }
}

// SEZON EKRANI
function openSeasonScreen() {
    document.getElementById('season-screen').style.display = 'flex';
    updateSeasonScreen();
}

function closeSeasonScreen() {
    document.getElementById('season-screen').style.display = 'none';
}

// Sayfa y√ºklendiƒüinde √ßalƒ±≈üacak kod
window.onload = function() {
    checkSeasonEnd();
    updateResources();
    checkAdmin();
    updateEmojiPreview();
};

updateResources();
</script>
</body>
</html>
